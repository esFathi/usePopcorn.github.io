{"ast":null,"code":"import _regeneratorRuntime from\"F:/project/react/jounas/usepopcorn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"F:/project/react/jounas/usepopcorn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"F:/project/react/jounas/usepopcorn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import StarRating from\"./StarRating\";import Loader from\"./Ui/Loader\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var MovieDetails=function MovieDetails(_ref){var _watched$find;var movieIdSelected=_ref.movieIdSelected,onCloseMovie=_ref.onCloseMovie,onAddwatched=_ref.onAddwatched,watched=_ref.watched;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),movie=_useState2[0],setMovie=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLosding=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),movieRating=_useState6[0],setMovieRating=_useState6[1];var title=movie.Title,year=movie.Year,poster=movie.Poster,runtime=movie.Runtime,imdbRating=movie.imdbRating,plot=movie.Plot,released=movie.Released,actors=movie.Actors,director=movie.Director,genre=movie.Genre;var getMovie=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:setIsLoading(true);_context.next=3;return fetch(\"http://www.omdbapi.com/?apikey=a862ad48&i=\".concat(movieIdSelected));case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;setMovie(data);setIsLoading(false);case 9:case\"end\":return _context.stop();}},_callee);}));return function getMovie(){return _ref2.apply(this,arguments);};}();useEffect(function(){var keyDownListener=function keyDownListener(e){if(e.code===\"Escape\"){onCloseMovie();}};document.addEventListener(\"keydown\",keyDownListener);return function(){document.removeEventListener(\"keydown\",keyDownListener);};},[onCloseMovie]);useEffect(function(){getMovie();},[movieIdSelected]);useEffect(function(){if(!title)return;document.title=\"Movie | \".concat(title);return function(){document.title=\"usePopcorn\";};},[title]);var newWatched={imdbID:movieIdSelected,title:title,year:year,poster:poster,imdbRating:+imdbRating,runtime:runtime&&Number(runtime.split(\" \").at(0)),userRating:+movieRating};var isExist=watched.map(function(movie){return movie.imdbID;}).includes(movieIdSelected);var watchedUserRating=(_watched$find=watched.find(function(movie){return movie.imdbID===movieIdSelected;}))===null||_watched$find===void 0?void 0:_watched$find.userRating;return/*#__PURE__*/_jsx(\"div\",{className:\"details\",children:isLosding?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-back\",onClick:onCloseMovie,children:\"\\u2190\"}),/*#__PURE__*/_jsx(\"img\",{src:poster,alt:\"Poster of \".concat(title,\" movie\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-overview\",children:[/*#__PURE__*/_jsx(\"h2\",{children:title}),/*#__PURE__*/_jsxs(\"p\",{children:[released,\" \\u2022 \",runtime]}),/*#__PURE__*/_jsx(\"p\",{children:genre}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u2B50\"}),imdbRating,\" IMDB rating\"]})]})]}),/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"rating\",children:!isExist?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(StarRating,{size:24,maxRating:10,onSetRating:setMovieRating}),movieRating>0&&/*#__PURE__*/_jsx(\"button\",{className:\"btn-add\",onClick:function onClick(){return onAddwatched(newWatched);},children:\"+ Add movie to list\"}),\" \"]}):/*#__PURE__*/_jsxs(\"p\",{children:[\"You have already rated this movie\",\" \",/*#__PURE__*/_jsxs(\"span\",{children:[watchedUserRating,\"\\u2B50\"]})]})}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsx(\"em\",{children:plot})}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Starring \",actors]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Directed by \",director]})]})]})});};export default MovieDetails;","map":{"version":3,"names":["React","useEffect","useState","StarRating","Loader","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","MovieDetails","_ref","_watched$find","movieIdSelected","onCloseMovie","onAddwatched","watched","_useState","_useState2","_slicedToArray","movie","setMovie","_useState3","_useState4","isLosding","setIsLoading","_useState5","_useState6","movieRating","setMovieRating","title","Title","year","Year","poster","Poster","runtime","Runtime","imdbRating","plot","Plot","released","Released","actors","Actors","director","Director","genre","Genre","getMovie","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","wrap","_callee$","_context","prev","next","fetch","concat","sent","json","stop","apply","arguments","keyDownListener","e","code","document","addEventListener","removeEventListener","newWatched","imdbID","Number","split","at","userRating","isExist","map","includes","watchedUserRating","find","className","children","onClick","src","alt","size","maxRating","onSetRating"],"sources":["F:/project/react/jounas/usepopcorn/src/components/MovieDetails.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport StarRating from \"./StarRating\";\r\nimport Loader from \"./Ui/Loader\";\r\n\r\nconst MovieDetails = ({\r\n  movieIdSelected,\r\n  onCloseMovie,\r\n  onAddwatched,\r\n  watched,\r\n}) => {\r\n  const [movie, setMovie] = useState({});\r\n  const [isLosding, setIsLoading] = useState(false);\r\n  const [movieRating, setMovieRating] = useState(0);\r\n\r\n  const {\r\n    Title: title,\r\n    Year: year,\r\n    Poster: poster,\r\n    Runtime: runtime,\r\n    imdbRating,\r\n    Plot: plot,\r\n    Released: released,\r\n    Actors: actors,\r\n    Director: director,\r\n    Genre: genre,\r\n  } = movie;\r\n\r\n  const getMovie = async () => {\r\n    setIsLoading(true);\r\n    const response = await fetch(\r\n      `http://www.omdbapi.com/?apikey=a862ad48&i=${movieIdSelected}`\r\n    );\r\n    const data = await response.json();\r\n    setMovie(data);\r\n    setIsLoading(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const keyDownListener = (e) => {\r\n      if (e.code === \"Escape\") {\r\n        onCloseMovie();\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"keydown\", keyDownListener);\r\n\r\n    return () => {\r\n      document.removeEventListener(\r\n        \"keydown\",\r\n        keyDownListener\r\n      );\r\n    };\r\n  }, [onCloseMovie]);\r\n\r\n  useEffect(() => {\r\n    getMovie();\r\n  }, [movieIdSelected]);\r\n\r\n  useEffect(() => {\r\n    if (!title) return;\r\n    document.title = `Movie | ${title}`;\r\n\r\n    return () => {\r\n      document.title = \"usePopcorn\";\r\n    };\r\n  }, [title]);\r\n\r\n  const newWatched = {\r\n    imdbID: movieIdSelected,\r\n    title,\r\n    year,\r\n    poster,\r\n    imdbRating: +imdbRating,\r\n    runtime: runtime && Number(runtime.split(\" \").at(0)),\r\n    userRating: +movieRating,\r\n  };\r\n\r\n  const isExist = watched\r\n    .map((movie) => movie.imdbID)\r\n    .includes(movieIdSelected);\r\n\r\n  const watchedUserRating = watched.find(\r\n    (movie) => movie.imdbID === movieIdSelected\r\n  )?.userRating;\r\n\r\n  return (\r\n    <div className='details'>\r\n      {isLosding ? (\r\n        <Loader />\r\n      ) : (\r\n        <>\r\n          <header>\r\n            <button\r\n              className='btn-back'\r\n              onClick={onCloseMovie}\r\n            >\r\n              &larr;\r\n            </button>\r\n            <img\r\n              src={poster}\r\n              alt={`Poster of ${title} movie`}\r\n            />\r\n            <div className='details-overview'>\r\n              <h2>{title}</h2>\r\n              <p>\r\n                {released} &bull; {runtime}\r\n              </p>\r\n              <p>{genre}</p>\r\n              <p>\r\n                <span>⭐</span>\r\n                {imdbRating} IMDB rating\r\n              </p>\r\n            </div>\r\n          </header>\r\n\r\n          <section>\r\n            <div className='rating'>\r\n              {!isExist ? (\r\n                <>\r\n                  <StarRating\r\n                    size={24}\r\n                    maxRating={10}\r\n                    onSetRating={setMovieRating}\r\n                  />\r\n                  {movieRating > 0 && (\r\n                    <button\r\n                      className='btn-add'\r\n                      onClick={() =>\r\n                        onAddwatched(newWatched)\r\n                      }\r\n                    >\r\n                      + Add movie to list\r\n                    </button>\r\n                  )}{\" \"}\r\n                </>\r\n              ) : (\r\n                <p>\r\n                  You have already rated this movie{\" \"}\r\n                  <span>{watchedUserRating}⭐</span>\r\n                </p>\r\n              )}\r\n            </div>\r\n            <p>\r\n              <em>{plot}</em>\r\n            </p>\r\n            <p>Starring {actors}</p>\r\n            <p>Directed by {director}</p>\r\n          </section>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MovieDetails;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}